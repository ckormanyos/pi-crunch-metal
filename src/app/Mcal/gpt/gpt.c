


/*******************************************************************************************************************
** Includes
*******************************************************************************************************************/
#include"gpt.h"

/*******************************************************************************************************************
** Defines
*******************************************************************************************************************/


/*******************************************************************************************************************
** Globals 
*******************************************************************************************************************/


/*******************************************************************************************************************
** Static functions
*******************************************************************************************************************/


/*******************************************************************************************************************
** Function:    
** Description: 
** Parameter:   
** Return:      
*******************************************************************************************************************/
void gpt_InitArmTimer(uint32 timeout)
{
  GPT_ARM_TIMER_CONTROL->bit.TimerSize = GPT_ARM_TIMER_CTL_32BIT;
  GPT_ARM_TIMER_CONTROL->bit.TimerPre  = GPT_ARM_TIMER_CTL_DIV_1;
  GPT_ARM_TIMER_CONTROL->bit.IntEnable = GPT_ARM_TIMER_CTL_INTERRUPT_ENABLED;
  GPT_ARM_TIMER_LOAD                   = (uint32)timeout;
  GPT_ARM_TIMER_CONTROL->bit.DebugMode = 1;
  GPT_ARM_TIMER_PRE_DIV->bit.PreDiv    = 249; //dividing APB_CLK (250 MHz) by 249 + 1 (250) -> 1 MHz
}

/*******************************************************************************************************************
** Function:    
** Description: 
** Parameter:   
** Return:      
*******************************************************************************************************************/
void gpt_StartArmTimer(void)
{
  GPT_ARM_TIMER_CONTROL->bit.TimerEn = GPT_ARM_TIMER_CTL_MODULE_ENABLED;
  GPT_ARM_TIMER_CONTROL->bit.FRCEn   = GPT_ARM_TIMER_CTL_COUNTER_ENABLED;
}

/*******************************************************************************************************************
** Function:    
** Description: 
** Parameter:   
** Return:      
*******************************************************************************************************************/
void gpt_StopArmTimer(void)
{
  GPT_ARM_TIMER_CONTROL->bit.TimerEn = GPT_ARM_TIMER_CTL_MODULE_DISABLED;
  GPT_ARM_TIMER_CONTROL->bit.FRCEn   = GPT_ARM_TIMER_CTL_COUNTER_DISABLED;
}

